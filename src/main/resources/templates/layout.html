<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:fragment="layout (content)">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title th:text="${title} ?: 'Unisights'">Unisights</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<nav class="navbar navbar-expand-lg bg-white border-bottom">
    <div class="container">
        <a class="navbar-brand fw-bold" href="/">Unisights</a>
        <div class="ms-auto">
            <a class="btn btn-outline-primary me-2" href="/auth/login">Login</a>
            <a class="btn btn-primary" href="/auth/signup">Sign up</a>
        </div>
    </div>
</nav>
<main class="container py-4">
    <div th:replace="${content}">
        <!-- Content will be replaced -->
    </div>
</main>
<div id="toast" class="position-fixed bottom-0 end-0 m-3 alert d-none" role="status" aria-live="polite"></div>

<script>
    function toast(msg, type='danger') {
      const t = document.getElementById('toast');
      t.className = 'alert alert-' + type + ' d-block';
      t.innerText = msg;
      setTimeout(()=>{ t.className = 'alert d-none'; }, 3000);
    }

    async function safeFetch(url, opts) {
      const r = await fetch(url, opts);
      if (!r.ok) {
        try {
          const e = await r.json();
          toast(e.error || 'Error', 'danger');
        } catch (err) {
          toast('Error', 'danger');
        }
        throw new Error('Request failed');
      }
      return r;
    }
</script>

</body>
</html>